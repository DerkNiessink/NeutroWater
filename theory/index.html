<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://example.com/theory/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Theory and Methodology - Neutron Moderation MC</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Theory and Methodology";
        var mkdocs_page_input_path = "theory.md";
        var mkdocs_page_url = "/theory/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
 <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Neutron Moderation MC
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../install_guide/">Quick Install Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../introduction/">Introduction</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Theory and Methodology</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-general-program-flow">1. General Program Flow</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-neutron-physics">2. Neutron Physics</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#21-initial-energy-spectrum">2.1 Initial Energy Spectrum</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#22-cross-sections">2.2 Cross Sections</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#23-distance-to-next-collision">2.3 Distance to Next Collision</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#24-neutron-interactions">2.4 Neutron Interactions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#25-transforming-coordinates">2.5 Transforming Coordinates</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#26-thermal-motion">2.6 Thermal Motion</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-geometry">3 Geometry</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-monte-carlo-sampling">4 Monte Carlo Sampling</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-interpolation">5 Interpolation</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../results/">Results</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../user_guide/">User Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../references/">References</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Neutron Moderation MC</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Theory and Methodology</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="theory-and-methodology">Theory and Methodology</h1>
<h2 id="1-general-program-flow">1. General Program Flow</h2>
<p>The software conducts a collision-driven Monte Carlo simulation, where it simulates each particle individually. Prior to running the simulation, it must undergo initialization, which involves the following steps:</p>
<ul>
<li>Interpolating the total, absorbtion, and scattering cross section data.</li>
<li>Interpolating data of the initial energy distribution of the neutrons.</li>
<li>Sampling the initial neutron energies from the energy distribution.</li>
<li>Setting the initial position and energies of the neutrons.</li>
<li>Setting the position and size of the tank.</li>
</ul>
<p>The initial spectrum is discussed in <a href="./#21-initial-energy-spectrum">Spectrum</a>, the method of sampling from a distribution is described in <a href="./#3-monte-carlo-sampling">Monte Carlo Sampling</a>, and the interpolation of distributions in <a href="./#4-interpolation">Interpolation</a>. After the initializing, the actual simulation of the diffusing neutrons can start. Each neutron's energy and position is updated consecutively which consists of the following steps:</p>
<ol>
<li>Give the neutron a random direction.</li>
<li>Check if the neutron is inside the tank, if false end the loop else continue.</li>
<li>Get the total cross section corresponding to the current energy of the neutron. </li>
<li>Determine the nuclide with which the neutron collides.</li>
<li>Compute the mean free path of the neutron and sample the distance to the next collision.</li>
<li>Determine the type of reaction. If it is absorption, end the loop; if it is elastic scattering, proceed.</li>
<li>Sample a direction from the angular distribution and compute the associated energy loss fraction. </li>
<li>Update the Neutron's position and energy.</li>
<li>Repeat steps 2-8 until the neutron either escaped or is absorbed.</li>
</ol>
<p>Positions and energies of the neutrons are stored. Several properties can be computed and measured from this data post-simulation. Each step is discussed in more detail in the following sections:</p>
<table>
<thead>
<tr>
<th>Steps</th>
<th>Section</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td><a href="./#2-geometry">Geometry</a></td>
</tr>
<tr>
<td>3-4</td>
<td><a href="./#11-cross-sections">Cross Sections</a></td>
</tr>
<tr>
<td>5</td>
<td><a href="./#13-distance-to-next-collision">Distance To Next Collision</a></td>
</tr>
<tr>
<td>6</td>
<td><a href="./#11-cross-sections">Cross Sections</a></td>
</tr>
<tr>
<td>7-8</td>
<td><a href="./#14-transforming-coordinates">Transforming Coordinates</a></td>
</tr>
</tbody>
</table>
<h2 id="2-neutron-physics">2. Neutron Physics</h2>
<h3 id="21-initial-energy-spectrum">2.1 Initial Energy Spectrum</h3>
<h3 id="22-cross-sections">2.2 Cross Sections</h3>
<p>The cross section indicates the likelihood of a particular interaction occurring between two particles. It is influenced by two main factors: the types of particles involved and their energies. In our scenario, there are two possible combinations of particles in an interaction: a neutron with an H-nucleus and a neutron with an O-nucleus. Unfortunately, it's not possible to calculate the cross section as a function of energy analytically. However, there is an abundance of freely accessible nuclear data available to everyone. In the program, cross section data from <a href="https://www.nndc.bnl.gov/endf-b8.0/">ENDF/B</a> is used an interpolated following the procedure outlined in <a href="#5-interpolation">Interpolation</a>.</p>
<p>In various reactions, different cross sections are involved. To proceed, we employ the following notations:</p>
<p><center></p>
<table>
<thead>
<tr>
<th>Notation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<script type="math/tex">\sigma_{H, tot}, \sigma_{O, tot}</script>
</td>
<td>Total cross section for the specified nuclide.</td>
</tr>
<tr>
<td>
<script type="math/tex">\sigma_{H, s}, \sigma_{O, s}</script>
</td>
<td>Scattering cross section for the specified nuclide.</td>
</tr>
<tr>
<td>
<script type="math/tex">\sigma_{H, a}, \sigma_{O, a}</script>
</td>
<td>Absorption cross section for the specified nuclide.</td>
</tr>
<tr>
<td>
<script type="math/tex">\Sigma_{H_2O}, \Sigma_{H}, \Sigma_{O}</script>
</td>
<td>Total macroscopic for the specified nuclide or molecule.</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>The theory behind these reactions is described in detail in <a href="./#23-neutron-interactions">Neutron Interactions</a>. For each type of cross section of the nuclides there are separate datafiles. Total macroscopic cross section for a molecule can be computed as follows:</p>
<p>
<script type="math/tex; mode=display">\Sigma = \sum_i N_i \sigma_i, </script>
</p>
<p>where <script type="math/tex">N_i</script> is the atomic density of atoms of type <script type="math/tex">i</script>:</p>
<p>
<script type="math/tex; mode=display"> N_i = \frac{\rho N_a}{M} n_i, </script>
</p>
<p>where <script type="math/tex">\rho</script> is the density of the compound, <script type="math/tex">M</script> the molecular weight, <script type="math/tex">N_a</script> Avogrado's constant, and <script type="math/tex">n_i</script> the number of atoms of type <script type="math/tex">i</script> in the molecule. Thus, the total macrocscopic cross section for <script type="math/tex">H_2O</script> is given by:</p>
<p>
<script type="math/tex; mode=display">\Sigma_{H_2O} = \frac{\rho_{H_20} N_a}{M_{H_20}} (2 \sigma_{H, t} + \sigma_{O, t}).</script>
</p>
<p>The cross sections in barns (<script type="math/tex">10^{-28} m^2</script>) as a function of neutron energy for the O and H nuclide are shown in Figure 1 and 2.</p>
<p><center></p>
<figure>
  <a class="glightbox" href="../figures/H_cross.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Hydrogen Cross Sections" src="../figures/H_cross.png" width="400" /></a>
  <figcaption><i>Figure 1: Hydrogen cross sections in barns at temperature T=300K.</i></figcaption>
</figure>
<figure>
  <a class="glightbox" href="../figures/O_cross.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Oxygen Cross Sections" src="../figures/O_cross.png" width="400" /></a>
  <figcaption><i>Figure 2: Oxygen cross sections in barns at temperature T=300K.</i></figcaption>
</figure>
<p></center></p>
<h3 id="23-distance-to-next-collision">2.3 Distance to Next Collision</h3>
<p>The distance to the next collision <script type="math/tex">l</script> follows a distribution function given by:</p>
<p>
<script type="math/tex; mode=display"> p(l)dl=\Sigma e^{-\Sigma l}dl, </script>
</p>
<p>where <script type="math/tex">\Sigma</script> is the total macroscopic cross section of an arbitrary material. Integrating both sides to some distance <script type="math/tex">l</script> gives:</p>
<p>
<script type="math/tex; mode=display"> \int_0^l dl'p(l') = 1 - e^{\Sigma l}. </script>
</p>
<p>As the probability distribution is normalized, we can set the this cummulative distribution to a uniformly distributed random 
number <script type="math/tex">\xi</script> on the interval <script type="math/tex"> [0, 1) </script>. Isolating <script type="math/tex">l </script> and using that in this case <script type="math/tex">\Sigma \equiv \Sigma_{H_2O} </script>, gives us a formula for sampling the distance to the next collision:</p>
<p>
<script type="math/tex; mode=display"> l = -\frac{\ln{\xi}}{\Sigma_{H_2O}}. </script>
</p>
<h3 id="24-neutron-interactions">2.4 Neutron Interactions</h3>
<p>To determine the type of reaction involving a nuclide, we initially identify which type of nuclide the neutron interacts with, either <script type="math/tex"> H</script> or <script type="math/tex"> O</script>. The probability of the neutron interacting with H is determined by::</p>
<p>
<script type="math/tex; mode=display"> P(H) = \frac{2\sigma_{H,tot} }{2\sigma_{H, tot} + \sigma_{O, tot}}.</script>
</p>
<p>If <script type="math/tex">\xi < P(H)</script>, where <script type="math/tex">\xi</script> is another uniformly distributed random number on the interval <script type="math/tex"> [0, 1) </script>, the neutron interacts with an <script type="math/tex"> H </script> nuclide; otherwise, it interacts with an <script type="math/tex"> O </script> nuclide.</p>
<p>Once the nuclide of interaction is determined, it is necessary to consider the reactions that can take place. Firstly we check absorbtion. The probability for absorbtion is given by:</p>
<p>
<script type="math/tex; mode=display"> P(\text{absorbtion}) = \frac{\sigma_{i,a}}{\sigma_{i,tot}},</script>
</p>
<p>where <script type="math/tex"> \sigma_{i, tot} </script> and <script type="math/tex"> \sigma_{i, a} </script> are the total and absorbtion cross section of the previously identified nuclide respectively. Again, if <script type="math/tex">\xi < P(\text{absorbtion})</script>, then the neutron is absorbed by the nuclide. Absorption results in the complete dissipation of the neutron's energy and we proceed to simulate the next neutron. </p>
<p>If the criteria mentioned above is not met, we consider a scattering interaction. This interaction results in a energy loss of the neutron, which dependends on the outgoing angle. </p>
<h3 id="25-transforming-coordinates">2.5 Transforming Coordinates</h3>
<h3 id="26-thermal-motion">2.6 Thermal Motion</h3>
<h2 id="3-geometry">3 Geometry</h2>
<h2 id="4-monte-carlo-sampling">4 Monte Carlo Sampling</h2>
<h2 id="5-interpolation">5 Interpolation</h2>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../introduction/" class="btn btn-neutral float-left" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../results/" class="btn btn-neutral float-right" title="Results">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../introduction/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../results/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

<script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>
